<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QCBOR: Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">QCBOR
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Overview</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="Overview"></a> </p>
<h1><a class="anchor" id="autotoc_md30"></a>
QCBOR Overview</h1>
<p>This implements CBOR &ndash; Concise Binary Object Representation as defined in <a href="https://www.rfc-editor.org/rfc/rfc8949.html">RFC 8949</a>. More information is at <a href="http://cbor.io">http://cbor.io</a>. This is a near-complete implementation of the specification. <a href="https://www.rfc-editor.org/rfc/rfc8742.html">RFC 8742</a> CBOR Sequences is also supported. Limitations are listed further down.</p>
<p>See <a class="el" href="qcbor__main__encode_8h.html#Encoding">Encoding</a> for general discussion on encoding, <a class="el" href="qcbor__main__decode_8h.html#BasicDecode">BasicDecode</a> for general discussion on the basic decode features and <a class="el" href="qcbor__spiffy__decode_8h.html#SpiffyDecode">SpiffyDecode</a> for general discussion on the easier-to-use decoder functions.</p>
<p>CBOR is intentionally designed to be translatable to JSON, but not all CBOR can convert to JSON. See RFC 8949 for more info on how to construct CBOR that is the most JSON friendly.</p>
<p>The memory model for encoding and decoding is that encoded CBOR must be in a contiguous buffer in memory. During encoding the caller must supply an output buffer and if the encoding would go off the end of the buffer an error is returned. During decoding the caller supplies the encoded CBOR in a contiguous buffer and the decoder returns pointers and lengths into that buffer for strings.</p>
<p>This implementation does not require malloc. All data structures passed in/out of the APIs can fit on the stack.</p>
<p>Decoding of indefinite-length strings is a special case that requires a "string allocator" to allocate memory into which the segments of the string are coalesced. Without this, decoding will error out if an indefinite-length string is encountered (indefinite-length maps and arrays do not require the string allocator). A simple string allocator called MemPool is built-in and will work if supplied with a block of memory to allocate. The string allocator can optionally use malloc() or some other custom scheme.</p>
<p>Here are some terms and definitions:</p>
<ul>
<li>"Item", "Data Item": An integer or string or such. The basic "thing" that CBOR is about. An array is an item itself that contains some items.</li>
<li>"Array": An ordered sequence of items, the same as JSON.</li>
<li>"Map": A collection of label/value pairs. Each pair is a data item. A JSON "object" is the same as a CBOR "map".</li>
<li>"Label": The data item in a pair in a map that names or identifies the pair, not the value. This implementation refers to it as a "label". JSON refers to it as the "name". The CBOR RFC refers to it this as a "key". This implementation chooses label instead because key is too easily confused with a cryptographic key. The COSE standard, which uses CBOR, has also chosen to use the term "label" rather than "key" for this same reason.</li>
<li>"Key": See "Label" above.</li>
<li>"Tag": A data item that is an explicitly labeled new data type made up of the tagging integer and the tag content. See <a class="el" href="md__2_users_2lgl_2_code_2_q_c_b_o_r_2dev_2doc_2_tagging.html#CBORTags">CBORTags</a>.</li>
<li>"Initial Byte": The first byte of an encoded item. Encoding and decoding of this byte is taken care of by the implementation.</li>
<li>"Additional Info": In addition to the major type, all data items have some other info. This is usually the length of the data but can be several other things. Encoding and decoding of this is taken care of by the implementation.</li>
</ul>
<p>CBOR has two mechanisms for tagging and labeling the data values like integers and strings. For example, an integer that represents someone's birthday in epoch seconds since Jan 1, 1970 could be encoded like this:</p>
<ul>
<li>First it is CBOR_MAJOR_TYPE_POSITIVE_INT (<a class="el" href="qcbor__main__decode_8h.html#aad060737704d85d5407ea2f342df9a66">QCBOR_TYPE_INT64</a>), the primitive positive integer.</li>
<li>Next it has a "tag" <a class="el" href="qcbor__common_8h.html#a7dedcb07c8058893a67efe42f6740990">CBOR_TAG_DATE_EPOCH</a> indicating the integer represents a date in the form of the number of seconds since Jan 1, 1970.</li>
<li>Last it has a string "label" like "BirthDate" indicating the meaning of the data.</li>
</ul>
<p>The encoded binary looks like this: </p><pre class="fragment"> a1                      # Map of 1 item
    69                   # Indicates text string of 9 bytes
      426972746844617465 # The text "BirthDate"
   c1                    # Tags next integer as epoch date
      1a                 # Indicates a 4-byte integer
          580d4172       # unsigned integer date 1477263730
</pre><p>Implementors using this API will primarily work with labels. Generally, tags are only needed for making up new data types. This implementation covers most of the data types defined in the RFC using tags. It also, allows for the use of custom tags if necessary.</p>
<p>This implementation explicitly supports labels that are text strings and integers. Text strings translate nicely into JSON objects and are very readable. Integer labels are much less readable but can be very compact. If they are in the range of 0 to 23, they take up only one byte.</p>
<p>CBOR allows a label to be any type of data including an array or a map. It is possible to use this API to construct and parse such labels, but it is not explicitly supported.</p>
<h2><a class="anchor" id="autotoc_md31"></a>
Limitations</h2>
<p>Summary limitations:</p><ul>
<li>The entire encoded CBOR must fit into contiguous memory.</li>
<li>Max size of encoded CBOR data is a few bytes less than <code>UINT32_MAX</code> (4GB).</li>
<li>Max array / map nesting level when encoding or decoding is <a class="el" href="qcbor__common_8h.html#adecdeb0c5bc02f8892a2c89cdae3e25e">QCBOR_MAX_ARRAY_NESTING</a> (this is typically 15).</li>
<li>Max items in an array or map when encoding or decoding is <a class="el" href="qcbor__common_8h.html#adb9b599e92af0a69453a8f8b61ec7777">QCBOR_MAX_ITEMS_IN_ARRAY</a> (typically 65,536).</li>
<li>Does not directly support labels in maps other than text strings &amp; integers.</li>
<li>Traversal, duplicate and sort order checking errors out for labels that are arrays or maps.</li>
<li>Does not directly support integer labels beyond whats fits in <code>int64_t</code> or <code>uint64_t</code>.</li>
<li>Epoch dates limited to <code>INT64_MAX</code> (+/- 292 billion years).</li>
<li>Exponents for bigfloats and decimal integers are limited to whats fits in <code>int64_t</code>.</li>
<li>Tags on labels are ignored during decoding.</li>
<li>The maximum tag nesting is <code>QCBOR_MAX_TAGS_PER_ITEM</code> (typically 4).</li>
<li>Works only on 32- and 64-bit CPUs.</li>
<li><a class="el" href="qcbor__tag__decode_8h.html#a309666f4994d76b00df5d3e3dc689d76" title="Decode some byte-string wrapped CBOR.">QCBORDecode_EnterBstrWrapped()</a> doesn't work on indefinite-length strings.</li>
</ul>
<p>The public interface uses <code>size_t</code> for all lengths. Internally the implementation uses 32-bit lengths by design to use less memory and fit structures on the stack. This limits the encoded CBOR it can work with to size <code>UINT32_MAX</code> (4GB).</p>
<p>This implementation requires two's compliment integers. While C doesn't require two's compliment, &lt;stdint.h&gt; does. Other parts of this implementation may also require two's compliment. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
