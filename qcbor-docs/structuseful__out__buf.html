<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QCBOR: useful_out_buf Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">QCBOR
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="headertitle"><div class="title">useful_out_buf Struct Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_useful_buf_8h_source.html">UsefulBuf.h</a>&gt;</code></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>UsefulOutBuf is a structure and functions (an object) for serializing data into a buffer to encode for a network protocol or write data to a file.</p>
<p>The main idea is that all the pointer manipulation is performed by <a class="el" href="_useful_buf_8h.html#a83f01ed9a781335a27e651b4d0fe99cd">UsefulOutBuf</a> functions so the caller doesn't have to do any pointer manipulation. The pointer manipulation is centralized. This code has been reviewed and written carefully so it spares the caller of much of this work and results in safer code with less effort.</p>
<p>The <a class="el" href="_useful_buf_8h.html#a83f01ed9a781335a27e651b4d0fe99cd">UsefulOutBuf</a> methods that add data to the output buffer always check the length and will never write off the end of the output buffer. If an attempt to add data that will not fit is made, an internal error flag will be set and further attempts to add data will not do anything.</p>
<p>There is no way to ever write off the end of that buffer when calling the <code>UsefulOutBuf_AddXxx()</code> and <code>UsefulOutBuf_InsertXxx()</code> functions.</p>
<p>The functions to add data do not report success of failure. The caller only needs to check for an error in the final call, either <a class="el" href="_useful_buf_8h.html#a08eb02690d07e40dfdda3286bc332dbf" title="Returns the data put into a UsefulOutBuf.">UsefulOutBuf_OutUBuf()</a> or <a class="el" href="_useful_buf_8h.html#a282b65088cb6f2f39c01edfbd06ca5a1" title="Copy out the data put into a UsefulOutBuf.">UsefulOutBuf_CopyOut()</a> to get the result. This makes the calling code cleaner.</p>
<p>There is a utility function to get the error status anytime along the way for a special circumstance. There are functions to see how much room is left and see if some data will fit too, but their use is generally unnecessary.</p>
<p>The general call flow is:</p>
<ul>
<li>Initialize by calling <a class="el" href="_useful_buf_8h.html#a913b2d897a56ee1ea3c0fd981160af31">UsefulOutBuf_Init()</a>. The output buffer given to it can be from the heap, stack or otherwise. <a class="el" href="_useful_buf_8h.html#a54fed8f0b3943666846bae738004dfbe">UsefulOutBuf_MakeOnStack</a> is a convenience macro that makes a buffer on the stack and initializes it.</li>
<li>Call methods like <a class="el" href="_useful_buf_8h.html#a14baa7dec0d821f7069a74de20d86ce4" title="Insert a NULL-terminated string into the UsefulOutBuf.">UsefulOutBuf_InsertString()</a>, <a class="el" href="_useful_buf_8h.html#a6ac934b99c15fc41c92d3197a2af6b19" title="Append an integer to the UsefulOutBuf.">UsefulOutBuf_AppendUint32()</a> and <a class="el" href="_useful_buf_8h.html#a09ea2a68453e34fea416d52017b4b37c" title="Inserts bytes into the UsefulOutBuf.">UsefulOutBuf_InsertUsefulBuf()</a> to output data. The append calls add data to the end of the valid data. The insert calls take a position argument.</li>
<li>Call <a class="el" href="_useful_buf_8h.html#a08eb02690d07e40dfdda3286bc332dbf" title="Returns the data put into a UsefulOutBuf.">UsefulOutBuf_OutUBuf()</a> or <a class="el" href="_useful_buf_8h.html#a282b65088cb6f2f39c01edfbd06ca5a1" title="Copy out the data put into a UsefulOutBuf.">UsefulOutBuf_CopyOut()</a> to see there were no errors and to get the serialized output bytes.</li>
</ul>
<p><a class="el" href="_useful_buf_8h.html#a83f01ed9a781335a27e651b4d0fe99cd">UsefulOutBuf</a> can be used in a mode to calculate the size of what would be output without actually outputting anything. This is useful to calculate the size of a buffer that is to be allocated to hold the output. See <a class="el" href="_useful_buf_8h.html#a7b4919809b569fd7fc5ead3fa926c9de">SizeCalculateUsefulBuf</a>.</p>
<p>Methods like <a class="el" href="_useful_buf_8h.html#ae85576eaefd482c7e6ee9483914f63af" title="Insert a 64-bit integer into the UsefulOutBuf.">UsefulOutBuf_InsertUint64()</a> always output in network byte order (big endian).</p>
<p>The possible errors are:</p>
<ul>
<li>The <a class="el" href="_useful_buf_8h.html#a83f01ed9a781335a27e651b4d0fe99cd">UsefulOutBuf</a> was not initialized or was corrupted.</li>
<li>An attempt was made to add data that will not fit.</li>
<li>An attempt was made to insert data at a position beyond the end of the buffer.</li>
<li>An attempt was made to insert data at a position beyond the valid data in the buffer.</li>
</ul>
<p>Some inexpensive simple sanity checks are performed before every data addition to guard against use of an uninitialized or corrupted UsefulOutBuf.</p>
<p><a class="el" href="_useful_buf_8h.html#a83f01ed9a781335a27e651b4d0fe99cd">UsefulOutBuf</a> has been used to create a CBOR encoder. The CBOR encoder has almost no pointer manipulation in it, is easier to read, and easier to review.</p>
<p>A <a class="el" href="_useful_buf_8h.html#a83f01ed9a781335a27e651b4d0fe99cd">UsefulOutBuf</a> is small and can go on the stack:</p><ul>
<li>32 bytes (27 bytes plus alignment padding) on a 64-bit CPU</li>
<li>16 bytes (15 bytes plus alignment padding) on a 32-bit CPU </li>
</ul>
</div><hr/>The documentation for this struct was generated from the following file:<ul>
<li>/Users/lgl/Code/QCBOR/dev/inc/qcbor/<a class="el" href="_useful_buf_8h_source.html">UsefulBuf.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
